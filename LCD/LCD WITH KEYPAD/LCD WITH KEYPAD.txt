#include<htc.h>
#define display_port PORTC      //Data pins connected to port 2 on microcontroller
#define rs RB0  //RS pin connected to pin 2 of port 3
#define rw RB1  // RW pin connected to pin 3 of port 3
#define e RB2//E pin connected to pin 4 of port 3
#define r1 RD0
#define r2 RD1
#define r3 RD2
#define r4 RD3
#define c1 RD4
#define c2 RD5
#define c3 RD6
void keypad();
void msdelay(unsigned int time)  // Function for creating delay in milliseconds.
{
    unsigned i,j ;
    for(i=0;i<time;i++)    
    for(j=0;j<1275;j++);
}
void lcd_cmd(unsigned char command)  //Function to send command instruction to LCD
{
    display_port = command;
    rs= 0;
    rw=0;
    e=1;
    msdelay(1);
    e=0;
}
void lcd_data(unsigned int disp_data)  //Function to send display data to LCD
{
    display_port = disp_data;
    rs= 1;
    rw=0;
    e=1;
    msdelay(1);
    e=0;
}

 void lcd_init()    //Function to prepare the LCD  and get it ready
{
    lcd_cmd(0x38);  // for using 2 lines and 5X7 matrix of LCD
    msdelay(10);
    lcd_cmd(0x0F);  // turn display ON, cursor blinking
    msdelay(10);
    lcd_cmd(0x01);  //clear screen
    msdelay(10);
    lcd_cmd(0x80);  // bring cursor to position 1 of line 1
    msdelay(10);
}
void main()
{
	TRISC=0X00;
	TRISB=0X00;
	TRISD=0X00;
	PORTC=0XFF;
	PORTD=0XFF;
	PORTB=0XFF;
    unsigned char a[]="INDIAN";    //string of 14 characters with a null terminator.
    int l=0;
    lcd_init();
	while(1)
	{
		keypad();
	}
}
void keypad()
{
	while(1)
	{
	r1=r2=r3=r4=1;
	r1=0;
	if(c1==0)
	{
		lcd_data('1');
		msdelay(100);
	}
	else if(c2==0)
	{
		lcd_data('2');
		msdelay(100);
	}
	else if(c3==0)
	{
		lcd_data('3');
		msdelay(100);
	}
	r1=r2=r3=r4=1;
	r2=0;
	if(c1==0)
	{
		lcd_data('4');
		msdelay(100);
	}
	else if(c2==0)
	{
		lcd_data('5');
		msdelay(100);
	}
	else if(c3==0)
	{
		lcd_data('6');
		msdelay(100);
	}
	r1=r2=r3=r4=1;
	r3=0;
	if(c1==0)
	{
		lcd_data('7');
		msdelay(100);
	}
	else if(c2==0)
	{
		lcd_data('8');
		msdelay(100);
	}
	else if(c3==0)
	{
		lcd_data('9');
		msdelay(100);
	}
	
}
	}