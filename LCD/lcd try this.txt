#include<htc.h>
#define display_port PORTC      //Data pins connected to port 2 on microcontroller
#define rs RB0  //RS pin connected to pin 2 of port 3
#define rw RB1  // RW pin connected to pin 3 of port 3
#define e RB2//E pin connected to pin 4 of port 3
#define r1 RD0
#define r2 RD1
#define r3 RD2
#define r4 RD3
#define c1 RD4
#define c2 RD5
#define c3 RD6
void keypad();
void delay(int time);
void lcd_cmd(unsigned char command);
void lcd_data(unsigned int disp_data);
void lcd_init();
void main()
{
	TRISC=0X00;
	TRISB=0X00;
	TRISD=0X00;
	PORTC=0XFF;
	PORTD=0XFF;
	PORTB=0XFF;
    lcd_init();
	while(1)
	{
		keypad();
	}
}
void keypad()
{
	while(1)
	{
	r1=r2=r3=r4=1;
	r1=0;
	if(c1==0)
	{
		lcd_data('1');
		delay(100);
	}
	else if(c2==0)
	{
		lcd_data('2');
		delay(100);
	}
	else if(c3==0)
	{
		lcd_data('3');
		delay(100);
	}
	r1=r2=r3=r4=1;
	r2=0;
	if(c1==0)
	{
		lcd_data('4');
		delay(100);
	}
	else if(c2==0)
	{
		lcd_data('5');
		delay(100);
	}
	else if(c3==0)
	{
		lcd_data('6');
		delay(100);
	}
	r1=r2=r3=r4=1;
	r3=0;
	if(c1==0)
	{
		lcd_data('7');
		delay(100);
	}
	else if(c2==0)
	{
		lcd_data('8');
		delay(100);
	}
	else if(c3==0)
	{
		lcd_data('9');
		delay(100);
	}
	
}
	}
void lcd_init()    //Function to prepare the LCD  and get it ready
{
    lcd_cmd(0x38);  // for using 2 lines and 5X7 matrix of LCD
    delay(10);
    lcd_cmd(0x0F);  // turn display ON, cursor blinking
    delay(10);
    lcd_cmd(0x01);  //clear screen
    delay(10);
    lcd_cmd(0x80);  // bring cursor to position 1 of line 1
    delay(10);
}
void lcd_cmd(unsigned char command)  //Function to send command instruction to LCD
{
    display_port = command;
    rs= 0;
    rw=0;
    e=1;
   delay(1);
    e=0;
}
void lcd_data(unsigned int disp_data)  //Function to send display data to LCD
{
    display_port = disp_data;
    rs= 1;
    rw=0;
    e=1;
    delay(1);
    e=0;
}
void delay(int time)  // Function for creating delay in milliseconds.
{
    int i,j ;
    for(i=0;i<time;i++) 
    {   
    for(j=0;j<1000;j++);
    {
    }
    }
}
